================================================================================
EXPERIMENT: Typo Attack on Watermarked Text
================================================================================
Model: opt-1.3b
Watermark: unigram
Num samples: 200
Typo rate: 0.05
Device: cuda
================================================================================

[1/6] Loading C4 dataset...
Loading C4 RealNewsLike dataset...
This may take a few minutes for the first download...
Attempting to load C4 realnewslike dataset...
/home/hkanpak21/.cache/huggingface/modules/datasets_modules/datasets/c4/584d57ebe81c209b6c7f31727066d2c4b4bba37cb7092cdd83083d5ec11207db/c4.py:53: FutureWarning: Dataset 'c4' is deprecated and will be deleted. Use 'allenai/c4' instead.
  warnings.warn(
Dataset loaded successfully!
Collecting 200 samples...

✓ Loaded 200 C4 samples
  Example prompt: Google has announced that it will be shutting down its smart-messaging service Allo which it launche...
✓ Loaded 200 prompts

[2/6] Loading model: opt-1.3b...
Loading model: facebook/opt-1.3b...
✓ Model loaded: 1315.8M parameters

[3/6] Loading watermarker: unigram...
Detected model vocab size: 50272 (tokenizer vocab size: 50265)
✓ Watermarker loaded: UnigramWatermark

[4/6] Loading attack: Typo...
Traceback (most recent call last):
  File "/scratch/hkanpak21/Comp441GPW/experiment_scripts/exp_attack_typo.py", line 225, in <module>
    main()
  File "/scratch/hkanpak21/Comp441GPW/experiment_scripts/exp_attack_typo.py", line 107, in main
    attack = load_attack("typo", attack_params)
  File "/scratch/hkanpak21/Comp441GPW/experiment_scripts/utils.py", line 177, in load_attack
    return TypoAttack(**params)
TypeError: TypoAttack.__init__() got an unexpected keyword argument 'typo_rate'
