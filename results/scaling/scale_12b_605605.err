Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [01:14<02:28, 74.05s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:44<00:48, 48.59s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:47<00:00, 27.80s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:47<00:00, 35.96s/it]
Some parameters are on the meta device because they were offloaded to the cpu.
You shouldn't move a model that is dispatched using accelerate hooks.
You shouldn't move a model that is dispatched using accelerate hooks.
